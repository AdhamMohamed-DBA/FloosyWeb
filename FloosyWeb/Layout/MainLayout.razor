@inherits LayoutComponentBase
@inject NavigationManager Nav
@inject FirebaseService Firebase

<div class="page-shell">
    <main class="page-content">
        @Body
    </main>
</div>

@if (!string.IsNullOrEmpty(Firebase.CurrentUserId) && !Nav.Uri.EndsWith("/") && !Nav.Uri.Contains("/login"))
{
    <div class="bottom-nav">
        <a href="home" class="nav-item @(IsActive("home") ? "active" : "")" aria-current="@(IsActive("home") ? "page" : null)" aria-label="Go to Home page">
            <img src="images/home.png" class="nav-icon" />
            <span>Home</span>
        </a>
        <a href="bills" class="nav-item @(IsActive("bills") ? "active" : "")" aria-current="@(IsActive("bills") ? "page" : null)" aria-label="Go to Bills page">
            <img src="images/bill.png" class="nav-icon" />
            <span>Bills</span>
        </a>
        <a href="charts" class="nav-item @(IsActive("charts") ? "active" : "")" aria-current="@(IsActive("charts") ? "page" : null)" aria-label="Go to Charts page">
            <img src="images/chart.png" class="nav-icon" />
            <span>Charts</span>
        </a>
        <a href="debts" class="nav-item @(IsActive("debts") ? "active" : "")" aria-current="@(IsActive("debts") ? "page" : null)" aria-label="Go to Debts page">
            <img src="images/bill.png" class="nav-icon" />
            <span>Debts</span>
        </a>
        <a href="history" class="nav-item @(IsActive("history") ? "active" : "")" aria-current="@(IsActive("history") ? "page" : null)" aria-label="Go to History page">
            <img src="images/history.png" class="nav-icon" />
            <span>History</span>
        </a>
        <a href="settings" class="nav-item @(IsActive("settings") ? "active" : "")" aria-current="@(IsActive("settings") ? "page" : null)" aria-label="Go to Settings page">
            <img src="images/setting.png" class="nav-icon" />
            <span>Settings</span>
        </a>
    </div>
}

@code {
    bool IsActive(string href)
    {
        var relative = Nav.ToBaseRelativePath(Nav.Uri).ToLowerInvariant();
        return relative == href || relative.StartsWith(href + "/");
    }

    protected override void OnInitialized()
    {
        // ðŸ”¥ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¯Ø§Ù„Ø© Ø¯ÙŠ Ù‡Ù†Ø§ Ø¢Ù…Ù† Ø¹Ø´Ø§Ù† Ø§Ù„Ù€ JS Ø¨ÙŠÙƒÙˆÙ† Ø­Ù…Ù„
        Firebase.InitUser();
        Nav.LocationChanged += (s, e) => StateHasChanged();
    }
}